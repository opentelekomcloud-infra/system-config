applicationSets:
  - name: root-app-of-apps-infra
    project: infra
    applications:
      - name: argocd
        namespace: argocd
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: kubernetes/helm_charts/upstream/argo-cd
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values-{{ .cluster.name }}.yaml'
        clusters: [in-cluster]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true
      - name: argocd-additional-manifests
        namespace: argocd
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: github/system-config/kubernetes/helm_charts/local/argo-cd
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values-sealed-secrets.yaml -f values-argocd-applications.yaml -f values-argocd-applicationSets.yaml -f values-argocd-projects.yaml'
        clusters: [in-cluster]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true

  - name: cert-manager
    project: infra
    applications:
      - name: cert-manager
        namespace: cert-manager
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: kubernetes/helm_charts/upstream/cert-manager
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values-{{ .cluster.name }}.yaml'
        clusters: [otcinfra, otcinfra2, otcci, cloudmon-de, cloudmon-nl]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true
      - name: cert-manager-additional-manifests
        namespace: cert-manager
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: github/system-config/kubernetes/helm_charts/local/cert-manager
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values.yaml'
        clusters: [otcinfra, otcinfra2, otcci, cloudmon-de, cloudmon-nl]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true

  - name: prometheus
    project: infra
    applications:
      - name: prometheus
        namespace: monitoring
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: kubernetes/helm_charts/upstream/kube-prometheus-stack
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values-{{ .cluster.name }}.yaml'
        clusters: [otcci, otcinfra, otcinfra2, cloudmon-de, cloudmon-nl]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true
      - name: prometheus-additional-manifests
        namespace: monitoring
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: kubernetes/helm_charts/local/kube-prometheus-stack
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values.yaml'
        clusters: [otcci, otcinfra, otcinfra2, cloudmon-de, cloudmon-nl]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true

  - name: victoria-metrics-cluster
    project: infra
    applications:
      - name: victoria-metrics-cluster
        namespace: monitoring
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: kubernetes/helm_charts/upstream/victoria-metrics-cluster
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values-{{ .cluster.name }}.yaml'
        clusters: [otcinfra]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true
      - name: victoria-metrics-cluster-additional-manifests
        namespace: monitoring
        repoURL: 'https://github.com/opentelekomcloud-infra/system-config.git'
        targetRevision: main
        path: github/system-config/kubernetes/helm_charts/local/victoria-metrics-cluster
        pluginName: argocd-vault-plugin-helm-with-args
        pluginEnv: '-f values.yaml'
        clusters: [otcinfra]
        project: infra
        syncPolicy:
          automated:
            prune: true
            selfHeal: true
          syncOptions:
            - CreateNamespace=true
