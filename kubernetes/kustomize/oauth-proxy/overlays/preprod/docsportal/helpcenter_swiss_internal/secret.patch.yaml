---
apiVersion: v1
kind: Secret
metadata:
  name: oauth-proxy-config
stringData:
  oauth2-proxy.cfg: |
    http_address = "0.0.0.0:4180"
    provider = "oidc"
    redirect_url = "https://docs-swiss-int.eco-preprod.tsi-dev.otc-service.com/oauth2/callback"
    whitelist_domains = [
        "docs-swiss-int.eco-preprod.tsi-dev.otc-service.com"
    ]
    email_domains = [
        "telekom.de",
        "t-systems.com"
    ]
    upstreams = [
        "http://document-hosting.helpcenter-swiss-int.svc.cluster.local:8080"
    ]
    session_store_type = "redis"
    redis_connection_url = "redis://redis.redis.svc.cluster.local:6379"
    cookie_secure = true
    cookie_httponly = true
    cookie_samesite = "lax"
    insecure_oidc_allow_unverified_email = true
    client_id = "<path:secret/data/docsportal/helpcenter_swiss_internal/zitadel#clientId>"
    client_secret = "<path:secret/data/docsportal/helpcenter_swiss_internal/zitadel#clientSecret>"
    cookie_secret = "<path:secret/data/docsportal/helpcenter_swiss_internal/zitadel#cookieSecret>"
    oidc_issuer_url = "https://<path:secret/data/zitadel/config#base_url>"
    # Temporarily remove group restriction for testing
    # allowed_groups = [
    #     "/hc-swiss-internal"
    # ]
