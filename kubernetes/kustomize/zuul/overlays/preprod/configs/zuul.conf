[zookeeper]
hosts=zookeeper.zuul.svc.cluster.local:2281
tls_cert=/tls/client/tls.crt
tls_key=/tls/client/tls.key
tls_ca=/tls/client/ca.crt
# Session timeout in seconds - must be between server's min (20s) and max (180s)
# Lower value = faster failure detection but more sensitive to network issues
# Higher value = more tolerant of network issues but slower failure detection
session_timeout=120
# Timeout for connection attempts
timeout=30

[scheduler]
tenant_config=/etc/zuul-config/tenants/preprod/main.yaml
state_dir=/var/lib/zuul
relative_priority=true
prometheus_port=9091

[web]
listen_address=0.0.0.0
port=9000
status_url=https://zuul.eco-preprod.tsi-dev.otc-service.com
root=https://zuul.eco-preprod.tsi-dev.otc-service.com
prometheus_port=9091
# Serve logs from Swift object storage (no trailing slash - role provides full URL)
log_url=https://swift-proxy.eco-preprod.tsi-dev.otc-service.com/v1/AUTH_zuul-preprod-logs/zuul-preprod-logs
static_cache_expiry=0

[webclient]
url=https://zuul.eco-preprod.tsi-dev.otc-service.com
verify_ssl=true

[auth "gitea-actions"]
driver=HS256
allow_authz_override=true
realm=zuul.eco-preprod.tsi-dev.otc-service.com
client_id=gitea-actions
issuer_id=zuul.eco-preprod.tsi-dev.otc-service.com
secret=<path:secret/data/zuul/auth/gitea-actions#token>

[fingergw]
port=9079
user=zuul

[keystore]
password=<path:secret/data/zuul/keystore_password#password>

[merger]
git_dir=/var/lib/zuul/git
git_timeout=600
git_user_email=zuul@zuul.eco-preprod.tsi-dev.otc-service.com
git_user_name=OTC Zuul Preprod
prometheus_port=9091

[executor]
manage_ansible=true
ansible_root=/var/lib/zuul/managed_ansible
private_key_file=/var/lib/zuul-ssh/executor-ssh.key
disk_limit_per_job=5000
max_starting_builds=5
trusted_ro_paths=/var/run/zuul/trusted-ro:/var/lib/zuul/openstack-config
variables=/var/run/zuul/vars/site-vars.yaml
prometheus_port=9091
# Increase load multiplier to avoid unregistering due to high system load
# Default is 2.5 * num_cpus. With 8 CPUs, this allows up to 80 load average
load_multiplier=10.0

[database]
dburi=postgresql://<path:secret/data/zuul/database#username>:<path:secret/data/zuul/database#password>@<path:secret/data/zuul/database#host>:<path:secret/data/zuul/database#port>/<path:secret/data/zuul/database#database>?sslmode=require

[connection "github"]
name=github
driver=github
webhook_token=<path:secret/data/zuul/connections/github#webhook_token>
app_id=<path:secret/data/zuul/connections/github#app_id>
app_key=/var/lib/zuul-ssh/github.key

[connection "gitlab"]
name=gitlab
driver=gitlab
canonical_hostname=gitlab
cloneurl=ssh://git@git-ssh.tsi-dev.otc-service.com
server=git.tsi-dev.otc-service.com
api_token=<path:secret/data/zuul/connections/gitlab#api_token>
webhook_token=<path:secret/data/zuul/connections/gitlab#webhook_token>
sshkey=/var/lib/zuul-ssh/gitlab.key

[connection "opendev"]
name=opendev
driver=git
baseurl=https://opendev.org

[connection "gitea"]
name=gitea
driver=github
baseurl=https://gitea-api-adapter.zuul.svc.cluster.local
canonical_hostname=gitea.eco.tsi-dev.otc-service.com
webhook_token=<path:secret/data/zuul/connections/gitea#webhook_token>
api_token=<path:secret/data/zuul/connections/gitea#api_token>
sshkey=/var/lib/zuul-ssh/gitea.key
git_host=gitea.eco.tsi-dev.otc-service.com
git_ssh_port=2222
verify_ssl=false

[connection "smtp"]
name=smtp
driver=smtp
server=<path:secret/data/smtp_gw#host>
port=25
default_from=zuul@zuul.eco-preprod.tsi-dev.otc-service.com
default_to=DL-PBCOTCDELECOCERT@t-systems.com
user=<path:secret/data/smtp_gw#username>
password=<path:secret/data/smtp_gw#password>
use_starttls=True
