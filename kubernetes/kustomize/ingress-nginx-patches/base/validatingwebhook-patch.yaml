apiVersion: admissionregistration.k8s.io/v1
kind: ValidatingWebhookConfiguration
metadata:
  name: ingress-nginx-admission
  labels:
    app.kubernetes.io/name: ingress-nginx
    app.kubernetes.io/instance: ingress-nginx
    app.kubernetes.io/component: admission-webhook
spec:
  webhooks:
    - name: validate.nginx.ingress.kubernetes.io
      clientConfig:
        service:
          name: ingress-nginx-controller-admission
          namespace: ingress-nginx
          path: "/networking/v1/ingresses"
      rules:
        - apiGroups:
            - networking.k8s.io
          apiVersions:
            - v1
          operations:
            - CREATE
            - UPDATE
          resources:
            - ingresses
          scope: "*"
      failurePolicy: Ignore
      sideEffects: None
      admissionReviewVersions:
        - v1
        - v1beta1
      namespaceSelector:
        matchExpressions:
          - key: name
            operator: NotIn
            values:
              - cert-manager
              - kube-system
