---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: backstage
spec:
  template:
    spec:
      containers:
        - name: backstage
          imagePullPolicy: Always
          env:
            - name: LOG_LEVEL
              value: "debug"
            - name: NODE_ENV
              value: "production"
            - name: AUTH_ENVIRONMENT
              value: "production"
            - name: DANGEROUS_DISABLE_AUTH_POLICY
              value: "true"
          volumeMounts:
            - name: app-config
              mountPath: /tmp/app-config.production.yaml
              subPath: app-config.production.yaml
              readOnly: false
      volumes:
        - name: app-config
          secret:
            secretName: backstage-secret
            defaultMode: 0644
