---
- name: Prepare github config
  hosts: bridge.eco.tsi-dev.otc-service.com
  tasks:
    # We set root dir here rather then in the job vars to be able to trigger it locally
    - name: Register root dir
      set_fact:
        gitstyring_root_dir: "/home/zuul/src/github.com/opentelekomcloud-infra/gitstyring"
        gitstyring2_root_dir: "/home/zuul/src/gitlab/ecosystem/gitstyring"

    - name: manage people
      opentelekomcloud.gitcontrol.members:
        root: "{{ gitstyring2_root_dir }}"
        token: "{{ github_token }}"

    - name: manage teams
      opentelekomcloud.gitcontrol.teams:
        root: "{{ gitstyring2_root_dir }}"
        token: "{{ github_token }}"

    - name: manage repositories
      opentelekomcloud.gitcontrol.repositories:
        root: "{{ gitstyring_root_dir }}"
        token: "{{ github_token }}"
