# Threat Intelligence Security Group Configuration
# This file contains security group rules for blocking known malicious IPs
# Updated automatically by threat intelligence feeds

# Spamhaus DROP List Security Group
spamhaus_drop_sg: &spamhaus_drop_sg
  name: "spamhaus_drop_sg"
  description: "Block Spamhaus DROP list IPs"
  rules:
    # Rules will be generated automatically by update scripts
    # Example format:
    - protocol: "tcp"
      port_range_min: 1
      port_range_max: 65535
      remote_ip_prefix: "1.10.16.0/20"
      direction: "ingress"
      description: "Spamhaus DROP - Example malicious network"

# SANS Storm Center Security Group
sans_storm_sg: &sans_storm_sg
  name: "sans_storm_sg"
  description: "Block SANS Internet Storm Center IPs"
  rules:
    # Rules will be generated automatically by update scripts
    # Example format:
    - protocol: "tcp"
      port_range_min: 1
      port_range_max: 65535
      remote_ip_prefix: "89.248.165.0/24"
      direction: "ingress"
      description: "SANS Storm - Example attack source"

# AbuseIPDB Security Group
abuseipdb_sg: &abuseipdb_sg
  name: "abuseipdb_sg"
  description: "Block AbuseIPDB reported malicious IPs"
  rules:
    # Rules will be generated automatically by update scripts
    # Example format:
    - protocol: "tcp"
      port_range_min: 1
      port_range_max: 65535
      remote_ip_prefix: "185.220.100.0/22"
      direction: "ingress"
      description: "AbuseIPDB - Reported malicious activity"

# Consolidated Threat Intelligence Security Groups
threat_intelligence_security_groups:
  # Apply to all OTC clouds
  - cloud: "otc_vault_448_de_eco_infra"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_eco_infra"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_eco_infra"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_449_de_eco_infra"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_449_de_eco_infra"
    <<: *sans_storm_sg
  - cloud: "otc_vault_449_de_eco_infra"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_449_nl_eco_infra"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_449_nl_eco_infra"
    <<: *sans_storm_sg
  - cloud: "otc_vault_449_nl_eco_infra"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_448_de_database"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_database"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_database"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_448_de_apimon"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_apimon"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_apimon"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_448_de_zuul_pool1"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_zuul_pool1"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_zuul_pool1"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_448_de_zuul_pool2"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_zuul_pool2"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_zuul_pool2"
    <<: *abuseipdb_sg

  - cloud: "otc_vault_448_de_zuul_pool3"
    <<: *spamhaus_drop_sg
  - cloud: "otc_vault_448_de_zuul_pool3"
    <<: *sans_storm_sg
  - cloud: "otc_vault_448_de_zuul_pool3"
    <<: *abuseipdb_sg

  - cloud: "otccloudmon-de"
    <<: *spamhaus_drop_sg
  - cloud: "otccloudmon-de"
    <<: *sans_storm_sg
  - cloud: "otccloudmon-de"
    <<: *abuseipdb_sg

  - cloud: "otccloudmon-nl"
    <<: *spamhaus_drop_sg
  - cloud: "otccloudmon-nl"
    <<: *sans_storm_sg
  - cloud: "otccloudmon-nl"
    <<: *abuseipdb_sg

# Configuration for threat intelligence updates
threat_intel_config:
  update_interval: "3600"  # Update every hour
  sources:
    spamhaus:
      url: "https://www.spamhaus.org/drop/drop.txt"
      format: "cidr"
    sans:
      url: "https://isc.sans.edu/api/sources/attacks/1000/"
      format: "json"
    abuseipdb:
      url: "https://api.abuseipdb.com/api/v2/blacklist"
      format: "json"
      api_key_vault_path: "secret/abuseipdb/api_key"
